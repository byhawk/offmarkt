<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deal Baron Admin - Holdingler</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="admin-container">
        <main class="main-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">ðŸ“ˆ</div>
                    <div class="stat-content">
                        <h3 id="total-holdings">0</h3>
                        <p>Toplam Holding</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ðŸ’°</div>
                    <div class="stat-content">
                        <h3 id="total-value">â‚º0</h3>
                        <p>Toplam DeÄŸer</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ðŸ’µ</div>
                    <div class="stat-content">
                        <h3 id="total-dividends">â‚º0</h3>
                        <p>Toplam TemettÃ¼</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ðŸ“Š</div>
                    <div class="stat-content">
                        <h3 id="avg-diversification">0%</h3>
                        <p>Ort. Ã‡eÅŸitlendirme</p>
                    </div>
                </div>
            </div>

            <header class="header">
                <h1>Holdingler</h1>
                <div class="header-actions">
                    <button onclick="refreshHoldings()" class="btn-refresh">ðŸ”„ Yenile</button>
                </div>
            </header>

            <div class="section">
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Oyuncu</th>
                                <th>Hisse SayÄ±sÄ±</th>
                                <th>Toplam DeÄŸer</th>
                                <th>Kar/Zarar</th>
                                <th>AylÄ±k TemettÃ¼</th>
                                <th>Ã‡eÅŸitlendirme</th>
                            </tr>
                        </thead>
                        <tbody id="holdingsTable">
                            <tr><td colspan="6" class="loading">YÃ¼kleniyor...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <script src="js/auth.js"></script>
    <script src="js/sidebar.js"></script>
    <script src="js/api.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            checkAuth();
            loadHoldings();
        });

        async function loadHoldings() {
            try {
                const result = await API.call('/holding');
                if (result && result.success) {
                    updateStats(result.data);
                }
            } catch (error) {
                console.error('Load holdings error:', error);
            }
        }

        function updateStats(data) {
            const holding = data.holding;
            document.getElementById('total-holdings').textContent = '1';
            document.getElementById('total-value').textContent = 'â‚º' + formatCurrency(holding.totalValue || 0);
            document.getElementById('total-dividends').textContent = 'â‚º' + formatCurrency(holding.totalDividendReceived || 0);
            document.getElementById('avg-diversification').textContent = Math.round(holding.diversificationScore || 0) + '%';

            const tbody = document.getElementById('holdingsTable');
            tbody.innerHTML = `
                <tr>
                    <td>Sistem</td>
                    <td>${holding.shares?.length || 0}</td>
                    <td>â‚º${formatCurrency(holding.totalValue || 0)}</td>
                    <td>â‚º${formatCurrency(holding.profitLoss || 0)} (${(holding.profitLossPercentage || 0).toFixed(1)}%)</td>
                    <td>â‚º${formatCurrency(holding.monthlyDividend || 0)}</td>
                    <td>${Math.round(holding.diversificationScore || 0)}%</td>
                </tr>
            `;
        }

        function refreshHoldings() {
            loadHoldings();
        }

        function formatCurrency(amount) {
            return new Intl.NumberFormat('tr-TR').format(amount);
        }
    </script>
</body>
</html>
