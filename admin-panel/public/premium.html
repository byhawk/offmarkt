<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deal Baron Admin - Premium</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="admin-container">
        <main class="main-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">üíé</div>
                    <div class="stat-content">
                        <h3 id="total-players">0</h3>
                        <p>Premium Oyuncu</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üí∞</div>
                    <div class="stat-content">
                        <h3 id="total-gems">0</h3>
                        <p>Toplam Gem</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üíµ</div>
                    <div class="stat-content">
                        <h3 id="total-spent">‚Ç∫0</h3>
                        <p>Toplam Harcama</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚ö°</div>
                    <div class="stat-content">
                        <h3 id="active-boosts">0</h3>
                        <p>Aktif Boost</p>
                    </div>
                </div>
            </div>

            <header class="header">
                <h1>Premium Y√∂netimi</h1>
                <div class="header-actions">
                    <button onclick="refreshPremium()" class="btn-refresh">üîÑ Yenile</button>
                </div>
            </header>

            <div class="section">
                <h2>Premium Oyuncular</h2>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Oyuncu</th>
                                <th>Gem Bakiyesi</th>
                                <th>Toplam Satƒ±n Alƒ±nan</th>
                                <th>Toplam Harcanan</th>
                                <th>Aktif Boost</th>
                            </tr>
                        </thead>
                        <tbody id="premiumTable">
                            <tr><td colspan="5" class="loading">Y√ºkleniyor...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="section">
                <h2>Gem Fiyatlandƒ±rmasƒ±</h2>
                <div class="pricing-grid">
                    <div class="pricing-card">
                        <h3>100 Gem</h3>
                        <p class="price">$0.99</p>
                        <p class="bonus">Bonus: Yok</p>
                    </div>
                    <div class="pricing-card">
                        <h3>500 Gem</h3>
                        <p class="price">$4.99</p>
                        <p class="bonus">Bonus: +50 Gem (%10)</p>
                    </div>
                    <div class="pricing-card">
                        <h3>1000 Gem</h3>
                        <p class="price">$9.99</p>
                        <p class="bonus">Bonus: +200 Gem (%20)</p>
                    </div>
                    <div class="pricing-card">
                        <h3>5000 Gem</h3>
                        <p class="price">$49.99</p>
                        <p class="bonus">Bonus: +1500 Gem (%30)</p>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>Boost Fiyatlandƒ±rmasƒ±</h2>
                <div class="boost-grid">
                    <div class="boost-card">
                        <h3>‚ö° Satƒ±≈ü Boost</h3>
                        <p>Satƒ±≈ülarƒ± %50 artƒ±r</p>
                        <p class="cost">25 Gem / 1 saat</p>
                    </div>
                    <div class="boost-card">
                        <h3>üí∞ Fiyat ƒ∞ndirimi</h3>
                        <p>Fiyatlarƒ± %20 d√º≈ü√ºr</p>
                        <p class="cost">15 Gem / 1 saat</p>
                    </div>
                    <div class="boost-card">
                        <h3>üè¶ Faiz Boost</h3>
                        <p>Faizi %100 artƒ±r</p>
                        <p class="cost">30 Gem / 1 g√ºn</p>
                    </div>
                    <div class="boost-card">
                        <h3>‚è±Ô∏è Hƒ±z Artƒ±rma</h3>
                        <p>S√ºreyi 2x hƒ±zlandƒ±r</p>
                        <p class="cost">50 Gem / 1 g√ºn</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="js/auth.js"></script>
    <script src="js/sidebar.js"></script>
    <script src="js/api.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            checkAuth();
            loadPremiumData();
        });

        async function loadPremiumData() {
            try {
                const result = await getPremiumCurrencies();
                if (result && result.success) {
                    const currencies = result.data.currencies || [];
                    updateStats(currencies);
                    displayPremiums(currencies);
                } else {
                    console.error('Failed to load premium data:', result?.message);
                    document.getElementById('premiumTable').innerHTML = '<tr><td colspan="5" class="error">Veriler y√ºklenemedi</td></tr>';
                }
            } catch (error) {
                console.error('Load premium error:', error);
                document.getElementById('premiumTable').innerHTML = '<tr><td colspan="5" class="error">Baƒülantƒ± hatasƒ±</td></tr>';
            }
        }

        function updateStats(premiums) {
            let totalGems = 0;
            let totalSpent = 0;
            let totalBoosts = 0;

            premiums.forEach(p => {
                totalGems += p.gems;
                totalSpent += p.totalSpent;
                totalBoosts += p.activeBoosts.filter(b => b.isActive).length;
            });

            document.getElementById('total-players').textContent = premiums.length;
            document.getElementById('total-gems').textContent = totalGems;
            document.getElementById('total-spent').textContent = '‚Ç∫' + formatCurrency(totalSpent);
            document.getElementById('active-boosts').textContent = totalBoosts;
        }

        function displayPremiums(premiums) {
            const tbody = document.getElementById('premiumTable');
            if (!premiums || premiums.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="no-data">Premium oyuncu bulunamadƒ±</td></tr>';
                return;
            }

            tbody.innerHTML = premiums.map(p => `
                <tr>
                    <td>Oyuncu ${p.playerId.substring(0, 8)}</td>
                    <td>üíé ${p.gems}</td>
                    <td>‚Ç∫${formatCurrency(p.totalPurchased)}</td>
                    <td>‚Ç∫${formatCurrency(p.totalSpent)}</td>
                    <td>${p.activeBoosts.filter(b => b.isActive).length}</td>
                </tr>
            `).join('');
        }

        function refreshPremium() {
            loadPremiumData();
        }

        function formatCurrency(amount) {
            return new Intl.NumberFormat('tr-TR').format(amount);
        }
    </script>
    <style>
        .pricing-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .pricing-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }

        .pricing-card h3 {
            margin: 0 0 10px 0;
            font-size: 18px;
        }

        .pricing-card .price {
            font-size: 24px;
            font-weight: bold;
            margin: 10px 0;
        }

        .pricing-card .bonus {
            font-size: 12px;
            opacity: 0.9;
        }

        .boost-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .boost-card {
            background: #f3f4f6;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .boost-card h3 {
            margin: 0 0 10px 0;
            color: #1f2937;
        }

        .boost-card p {
            margin: 5px 0;
            color: #6b7280;
            font-size: 14px;
        }

        .boost-card .cost {
            font-weight: bold;
            color: #667eea;
            margin-top: 10px;
        }
    </style>
</body>
</html>
